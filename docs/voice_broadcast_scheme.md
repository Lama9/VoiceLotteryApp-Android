# 语音播报功能设计方案 (MP3预录制版)

本方案旨在使用预录制的 MP3 音频文件，为抽奖应用增加生动的语音反馈。
相比于 TTS (文字转语音)，MP3 方案音色更自然、更有感情，且无需联网或依赖系统引擎。

## 1. 核心逻辑设计

我们将创建一个单例管理类 `AudioManager` 来统一管理音频播放。

### 1.1 播放状态机

应用将分为三种音频状态：

1. **空闲等待期 (Idle)**:
    * **行为**: 循环随机播放“暖场语音”。
    * **逻辑**: 当不在抽奖中且无弹窗时，每隔一定时间（如 10秒~20秒）随机播放一条欢迎语或规则介绍。
2. **抽奖进行中 (Spinning)**:
    * **行为**: 用户点击开始或喊出“开始”瞬间，播放“启动音效/语音”。
    * **逻辑**: 打断当前的空闲语音，播放一次启动音。
3. **结果展示期 (Result)**:
    * **行为**: 抽奖结束弹出弹窗瞬间，播放“庆祝音效” + “奖品播报”。
    * **逻辑**:
        * 先播放通用的庆祝音效 (如 "Ta-da!")。
        * 紧接着播放对应奖品的专属语音 (如 "恭喜您获得一等奖")。
4. **空闲等待期 (Idle)**:
    * **行为**: 循环随机播放“暖场语音”。
    * **逻辑**: 当不在抽奖中且无弹窗时，每隔一定时间（如 10秒~20秒）随机播放一条欢迎语或规则介绍。
5. **抽奖进行中 (Spinning)**:
    * **行为**: 用户点击开始或喊出“开始”瞬间，播放“启动音效/语音”。
    * **逻辑**: 打断当前的空闲语音，播放一次启动音。
6. **结果展示期 (Result)**:
    * **行为**: 抽奖结束弹出弹窗瞬间，播放“庆祝音效” + “奖品播报”。
    * **逻辑**:
        * 先播放通用的庆祝音效 (如 "Ta-da!")。
        * 紧接着播放对应奖品的专属语音 (如 "恭喜您获得一等奖")。
        * 如果是“谢谢参与”，则播放遗憾/鼓励语音。

---

## 2. 您需要准备的音频文件

请录制或下载以下音频文件（支持 **MP3** 或 **M4A** 格式），采样率建议 **44100Hz**，单声道或立体声均可。

### 📂 存放位置

所有文件需放入 Android 项目的 **`app/src/main/res/raw`** 目录下。
*(如果 `raw` 文件夹不存在，即使告诉我，我会创建它)*

### 📝 文件清单与命名规范 (必须全小写)
>
> **注意**：文件名后缀请根据实际格式修改 (如 `idle_welcome_1.m4a`)，但为了代码统一，建议尽量统一使用一种格式。

#### A. 空闲/暖场语音 (建议准备 2-3 个)

用于无人操作时活跃气氛。

* `idle_intro_1.mp3`: 如 “对着手机说‘开始’就能抽奖哦！”
* `idle_waiting.mp3`: 如 “好运即将降临，快来试试吧。”

#### B. 操作反馈语音

* `sfx_spin_start.mp3`: 点击开始时的音效。如 “转盘转动啦，祝你好运！”

#### C. 结果播报语音 (关键)

为了精准播报，我们需要将音频与奖品对应。建议按 **奖品等级/名称** 命名。

**通用音效:**

* `sfx_win_fanfare.mp3`: 获奖瞬间的通用欢呼声/彩带声 (0.5秒 - 2秒)。
* `sfx_regret.mp3`: 未中奖/谢谢参与的遗憾音效。

**具体奖品语音 (示例):**

* `prize_rank_1.mp3`: “恭喜！您获得了一等奖！” (对应列表第1个奖品/红色奖)
* `prize_rank_2.mp3`: “太棒了！是二等奖！” (对应列表第2个奖品/橙色奖)
* `prize_rank_3.mp3`: “不错哦，三等奖到手！”
* `prize_new.mp3`: “获得全新奖项！”
* `prize_thanks.mp3`: “哎呀，差一点点，谢谢参与。” (对应“谢谢参与”类奖项)

> **💡 建议**:
> 由于我们在设置里可以随意添加奖品，**为了方便匹配**，我建议代码逻辑优先尝试 **按文件名匹配**。
> 比如您设置奖品名为“超级大奖”，您就准备一个 `prize_chaojidajiang.mp3` (拼音需约定) 或者简单点，我们采用 **按列表顺序** 匹配：
>
> * 列表第1个奖品 -> 播放 `prize_0.mp3`
> * 列表第2个奖品 -> 播放 `prize_1.mp3`
> * ...
> * 找不到对应文件 -> 播放通用 `sfx_win_fanfare.mp3`

---

## 3. 实现计划 (Next Steps)

如果您确认以上方案，且文件准备就绪（或者您先用几个假文件测试），我将进行以下代码开发：

1. **创建 `raw` 资源目录**: 建立存放音频的文件夹。
2. **编写 `SoundManager.java`**:
    * 实现 `playIdleLoop()`: 计时器控制随机播放。
    * 实现 `playStartSound()`: 动作触发。
    * 实现 `playResultSound(int prizeIndex, boolean isThanks)`: 智能拼接播放结果。
3. **集成到 `MainActivity`**:
    * 在 `onCreate` 初始化。
    * 在 `startLottery` 调用启动音。
    * 在 `showCustomDialog` 调用结果音。
    * 在 `onPause/onResume` 管理生命周期（切后台静音）。

**请确认**: 您倾向于用“按列表顺序命名 (`prize_0.mp3`)”还是“按奖项名字拼音/英文命名”？ (顺序命名最简单稳定，改名字不用改文件名)
